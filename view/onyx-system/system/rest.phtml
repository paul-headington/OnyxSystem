<div class="row">
    <div class="col-md-4">
        <div class="panel panel-default">
            <div class="panel-heading">
                <h3 class="panel-title">System Tools - Rest API</h3>
            </div>
            <div class="panel-body">
                <p>Here you can set the data objects that can be accessed and if they require auth or not (auth still work in progress)</p>  
                <h5>Add Custom Rest Point</h5>
                <form method="POST" action="/system/rest-add" class="form" role="form">
                    <div class="form-group">
                        <label class="sr-only" for="name">Name</label>
                        <input type="text" class="form-control" id="name" required="true" name="name" placeholder="Object Name">
                    </div>   
                    <div class="form-group">
                        <label class="sr-only" for="factory">Factory</label>
                        <input type="text" class="form-control" id="factory" required="true" name="factory" placeholder="Factory">
                    </div> 
                    <button type="submit" class="btn btn-default">Add Access</button>
                </form>
            </div>
        </div>
    </div>
    <div class="col-md-8">
        <div class="panel panel-default"> 
            <div class="panel-heading">
                <h3 class="panel-title">Data Object Access</h3>
            </div>            
            <form method="POST" action="/system/rest-api" role="form" class="form-horizontal">
                <div class="form-group">
                    <div class="col-sm-12">
                    <table class="table table-condensed">
                      <thead>
                        <tr>
                          <th>Table Name</th>
                          <th>Rest Object Name</th>
                          <th>Factory</th>
                          <th>Rest Access</th>
                          <th>Require Auth</th>
                          <th></th>
                        </tr>
                      </thead>
                      <tbody>
                        <?php foreach($this->tables as $object){?>                        
                        <tr>
                          <td><?php echo $object['tablename']; ?></td>                          
                          <td><input type="text" value="<?php echo $object['name']; ?>" name="name[<?php echo $object['tablename']; ?>]"/></td>    
                          <td><input type="text" value="<?php echo $object['factory']; ?>" name="factory[<?php echo $object['tablename']; ?>]"/></td>    
                          <td><label><input type="checkbox" <?php echo $object['checked']; ?> value="true" name="allow[<?php echo $object['tablename']; ?>]"/> Allow</label></td>
                          <td><label><input type="checkbox" <?php echo $object['auth']; ?> value="true" name="auth[<?php echo $object['tablename']; ?>]"/> Allow</label></td>   
                          <td><?php if($object['custom']){ ?><a href="/system/rest-delete/<?php echo $object['id']; ?>">delete</a><?php }?></td>
                        </tr>   
                        <?php }?>
                      </tbody>
                    </table>
                    </div>
                </div>  
                <div class="form-group">
                    <div class="col-sm-offset-8 col-sm-4">
                        <button type="submit" class="btn btn-default">Update Access</button>
                    </div>
                </div>
            </form>          
        </div>
    </div>
    
</div>
<?php 
if(is_array($this->messages)){ 
    $messageBody = '';
    foreach($this->messages as $message){
        $messageBody .= '<p>'.$message.'</p>';
    }  
?>
<script>
    $('#myModalLabel').html('System Message');
    $('#myModal .modal-body').html('<?php echo $messageBody;?>');
    $('#myModal').modal('show');
</script>
<?php }?>

